!function(){"use strict";angular.module("ionic-http-offline-cache",[]).provider("httpOfflineCache",function(){function e(e,t){if(angular.isArray(e)){t=t||[];for(var n=0,r=e.length;r>n;n++)t[n]=e[n]}else if(angular.isObject(e)){t=t||{};for(var o in e)("$"!==o.charAt(0)||"$"!==o.charAt(1))&&(t[o]=e[o])}return t||e}function t(e){return"[object File]"===toString.call(e)}function n(e){return"[object Blob]"===toString.call(e)}function r(e){return"[object FormData]"===toString.call(e)}function o(e){var t=e.match(c);return t&&f[t[0]].test(e)}function i(e,t){if(angular.isString(e)){var n=e.replace(l,"").trim();if(n){var r=t("Content-Type");(r&&0===r.indexOf(a)||o(n))&&(e=angular.fromJson(n))}}return e}var a="application/json",u={"Content-Type":a+";charset=utf-8"},c=/^\[|^\{(?!\{)/,f={"[":/]$/,"{":/}$/},l=/^\)\]\}',?\n/;this.defaults={transformResponse:[i],transformRequest:[function(e){return!angular.isObject(e)||t(e)||n(e)||r(e)?e:angular.toJson(e)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:e(u),put:e(u),patch:e(u)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},this.$get=["$http","$q","httpOfflineCacheStorage","$injector",function(e,t,n,r){function o(n,r){return i()?a(n,r):e.get(n,r).then(function(e){return u(e,n,r)})["catch"](function(e){return e.status?t.reject(e):a(n,r)})}function i(){return f?f.isOffline():!1}function a(e,r){return n.get(e).then(function(e){return e?e.response:t.reject({status:0,data:"",headers:function(){return""},config:r,statusText:""})})}function u(e,t,r){return n.set(t,{response:e,config:r}),e}function c(t){return t&&"GET"===t.method?o(t.url,t):e(t)}var f;return r.has("$cordovaNetwork")&&(f=r.get("$cordovaNetwork")),c.get=o,c.head=e.head.bind(e),c.post=e.post.bind(e),c.put=e.put.bind(e),c["delete"]=e["delete"].bind(e),c.jsonp=e.jsonp.bind(e),c.patch=e.patch.bind(e),c.isOffline=i,c.pendingRequests=e.pendingRequests,c.defaults=e.defaults,c}]})}(),function(){"use strict";angular.module("ionic-http-offline-cache").provider("httpOfflineCacheStorage",function(){var e,t="sqlite",n="localStorage",r="inMemory",o=[t,n,r],i=[t,n,r];this.setBackends=function(e){e.forEach(function(e){if(o.indexOf(e)<0)throw new Error("Invalid backend type for HttpOfflineCache "+e)}),i=e},this.$get=["$window","$q","$injector",function(o,a,u){function c(){function e(){return n?r?a.resolve(!0):(r=n.openDatabase({name:"httpOfflineCache.db",location:2}),t("CREATE TABLE IF NOT EXISTS items (id TEXT PRIMARY KEY, val TEXT)").then(function(){return!0})):a.reject(!1)}function t(t,n){var o=a.defer();if(n=n||[],!r)throw new Error("SQLite3 database not initialized yet");e().then(function(){return r.transaction(function(e){e.executeSql(t,n,function(e,t){o.resolve(t)},function(e){o.reject(e)})}),o.promise})}var n,r;return u.has("$cordovaSQLite")&&(n=u.get("$cordovaSQLite")),{isSupported:!!n,clear:function(){return t("DELETE FROM items")},has:function(e){return t("SELECT val FROM items WHERE id = ?",[e]).then(function(e){return e.rows.length>0})},get:function(e){return t("SELECT val FROM items WHERE id = ?",[e]).then(function(e){if(e.rows.length>0){var t=e.rows.item(0).val;return null===t||"undefined"==typeof t?void 0:angular.fromJson(t)}return void 0})},set:function(e,n){var r=angular.toJson(n);return t("REPLACE INTO items(id, val) VALUES (?, ?)",[e,r])},remove:function(e){return t("DELETE FROM items WHERE id = ?",[e])}}}function f(){var e="httpCache-";return{isSupported:function(){try{return"localStorage"in o&&null!==o.localStorage}catch(e){return!1}}(),clear:function(){for(var t=o.localStorage.length-1;t>=0;t--){var n=o.localStorage.key(t);0===n.indexOf(e)&&o.localStorage.removeItem(n)}return a.resolve(!0)},has:function(t){return a.resolve("undefined"!=typeof o.localStorage[e+t])},get:function(t){var n=o.localStorage.getItem(e+t);return null===n||"undefined"==typeof n?a.resolve(void 0):a.resolve(angular.fromJson(n))},set:function(t,n){var r=this,i=angular.toJson(n);try{o.localStorage.setItem(e+t,i)}catch(u){r.clear()}return a.resolve(!0)},remove:function(t){return o.localStorage.removeItem(e+t),a.resolve(!0)}}}function l(){var e={};return{isSupported:!0,clear:function(){return e={},a.resolve(!0)},has:function(t){return a.resolve("undefined"!=typeof e[t])},get:function(t){return a.resolve(e[t])},set:function(t,n){return e[t]=n,a.resolve(!0)},remove:function(t){return delete e[t],a.resolve(!0)}}}function s(){if(e=null,i.forEach(function(o){if(!e){if(o===t)e=c();else if(o===n)e=f();else{if(o!==r)throw new Error("Invalid backend type for HttpOfflineCache "+o);e=l()}e.isSupported||(e=null)}}),!e)throw new Error("No active storage backend for HttpOfflineCache ");return e}return s()}]})}();